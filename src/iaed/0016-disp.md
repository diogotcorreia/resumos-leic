---
description: Tabelas e Vetores.
---

# Tabelas de Dispersão (Hash Tables)

[[toc]]

## Tabelas de Dispersão

### Motivação

Numa tabela de dispersão, tanto para guradar como procurar um elemento,
a função de dispersão dá-nos um indíce.

### Função de Dispersão (Hashing)

- Transforma a chave num índice da tabela, ou seja num
  inteiro , para uma tabela de dimensão
- Colisão: ocorre quando a função de dispersão devolve
  o mesmo valor para chaves distintas
- Função de dispersão ideal: a probabilidade de ocorrer
  uma colisão para duas chaves distintas é
- Distribui os elementos de forma uniforme

- Deve distribuir as chaves de forma uniforme e quase
  aleatória
- Deve ser rápida de calcular
- Deve envolver todos os bits da chave
- Diferentes funções devem ser usadas para diferentes
  tipos de dados
- Cadeias de caracteres
- Inteiros
- Reais

- Para números

```c
int hash(int value, int M)
{
    return (value % M);
}
```

- Para strings

Calcula uma soma ponderada dos caracteres

- Soma é feita com módulo
- M deve ser um primo, para minimizar colisões

```c
int hash(char *v, int M)
{
int h = 0, a = 127;

for (; *v != ’\0’; v++)
    h = (a*h + *v) % M;
return h;
}
```

Também é possível

- Recalcula a base em cada iteração
- Evita anomalias com chaves altamente regulares

```c
int hashU(char *v, int M)
{
int h, a = 31415, b = 27183;

for (h = 0; *v != ’\0’; v++, a = a*b % (M-1))
    h = (a*h + *v) % M;
return h;
}
```

### Colisões

Por vezes diferentes chaves apontam para o mesmo local na tabela.

As implementacoes encontram-se nos slides no final da página

### Resolução por Encadeamento Externo

- Cada posição da tabela tem um ponteiro para uma lista
- Colisões resolvidas juntando o elemento ao início da lista
- Remoções resolvidas removendo o elemento da lista

Exemplo do código nos slides do final da página

- Comprimento médio das listas é
- A probabilidade de o número de chaves numa lista ser
  maior ou igual a é de onde
- Se , a probabilidade de uma lista ter mais de 40
  items é 0.0000016.

### Resolução por Procura Linear

- Cada posição da tabela guarda um elemento
- Necessário conhecer número de elementos à priori
- Se a posição estiver ocupada, guarda o item na posição
  seguinte livre (linear probing).

Exemplo do código nos slides do final da página

- Resolução de conflitos: se a posição correspondente ao
  índice devolvido pela função de dispersão estiver
  ocupada, incrementar o índice até encontrar primeira
  posição livre.

- Após achar o item, coloca-se a posição a NULL
- Reinserem-se todos os items que se seguem, até à próxima
  posição vazia

### Resolução por Double Hashing

- Guarda elementos na tabela, como na procura linear
- Usa outra técnica para resolver conflitos
- Em vez de procurar em sequência, usa uma segunda função de
  hashing para determinar o incremento
- Incremento deve ser maior que 0 e primo relativamente ao
  tamanho da tabela
- Diminui o número de operações relativamente à procura linear
- Operações só se tornam demasiado lentas quando o factor de
  carga atinge o valor 90% - 95%

Exemplo do código nos slides do final da página

### Tabelas de Dispersão Dinâmicas

- Carga da tabela aumenta - custo de inserção e procura
  aumenta
- tabela esparsa (ou encadeamento externo) - aumento é gradual
- tabela não esparsa - aumento incomportável
- procura linear e dispersão dupla - carga máxima 1
- Solução: duplicar tamanho da tabela quando esta fica
  meio cheia
- No entanto, duplicação tem custo alto
- mas, é pouco frequente

### Vantagens e Desvantagens

- Vantagens
- Concretizam operações de inserção e procura em tempo
  constante (caso médio)
- procura linear - a mais rápida (tabela esparsa)
- dispersão dupla - melhor compromisso tempo/memória
- encadeamento externo - mais fácil de concretizar, maior carga mas
  pior uso de memória
- Inconvenientes
- Não há garantia de desempenho
- Custo de função de dispersão alto se chaves longas
- Ocupam mais memória do que necessário
- Não suportam eficientemente as operações de ordenação e
  selecção

Slides:

- [Aula 18](https://drive.google.com/file/d/1YBSPqEe4hLfTO3Th1F0TeISqUb_N0JAs/view?usp=sharing)
